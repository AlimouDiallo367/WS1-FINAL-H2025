<?php
require_once "config.php";
require_once "session.php";

// $infos[] = "Un message d'information";
// $erreurs[] = "Un message d'erreur";
?>

<!DOCTYPE html>
<html lang="fr">

<head>
  <?php require_once 'section/head.phtml'; ?>
  <title>Inscription - Point Final</title>
</head>

<body>
  <?php require_once 'section/entete.phtml'; ?>

  <main class="container py-5" style="max-width: 600px;">
    <?php require_once 'section/retroaction.phtml'; ?>

    <div class="card shadow-sm">
      <div class="card-body">
        <h2 class="card-title text-center mb-4">Inscription</h2>

        <form method="post" action="inscription.phtml">
          <!-- Nom utilisateur -->
          <div class="mb-3">
            <label for="nom-utilisateur" class="form-label">Nom d'utilisateur</label>
            <input type="text" class="form-control" id="nom-utilisateur" name="nom-utilisateur" required maxlength="50">
          </div>

          <!-- Mot de passe -->
          <div class="mb-3">
            <label for="mot-de-passe" class="form-label">Mot de passe</label>
            <input type="password" class="form-control" id="mot-de-passe" name="mot-de-passe" required>
          </div>

          <div class="mb-3">
            <label for="confirmation-mot-de-passe" class="form-label">Confirmation mot de passe</label>
            <input type="password" class="form-control" id="confirmation-mot-de-passe" name="confirmation-mot-de-passe" required>
          </div>

          <hr>

          <!-- Nom complet -->
          <div class="mb-3">
            <label for="prenom" class="form-label">Prénom</label>
            <input type="text" class="form-control" id="prenom" name="prenom" required maxlength="50">
          </div>

          <div class="mb-3">
            <label for="nom" class="form-label">Nom de famille</label>
            <input type="text" class="form-control" id="nom" name="nom" required maxlength="50">
          </div>

          <!-- Bio -->
          <div class="mb-3">
            <label for="bio" class="form-label">Bio</label>
            <input type="text" class="form-control" id="bio" name="bio" required maxlength="255">
          </div>

          <!-- Image de profil -->
          <div class="mb-3">
            <label for="url-image" class="form-label">URL de votre image de profil</label>
            <div class="d-flex align-items-center gap-2">
              <img id="img-profil" src="assets/img/profil-defaut.jpg" alt="Image profil" class="rounded-circle" width="60" height="60">
              <input type="url" class="form-control" id="url-image" name="url-image" required placeholder="http://...">
            </div>
          </div>

          <!-- Bouton -->
          <div class="d-grid mt-4">
            <input type="submit" class="btn btn-primary" name="bouton-inscription" value="S'inscrire">
          </div>
        </form>

        <div class="text-center mt-4">
          <small>Déjà un compte ? <a href="connexion.phtml">Connectez-vous ici</a>.</small>
        </div>
      </div>
    </div>
  </main>

  <?php require_once 'section/pied.phtml'; ?>

  <script>
    document.getElementById('url-image').addEventListener('input', function () {
      const url = this.value.trim();
      const img = document.getElementById('img-profil');

      if (url.match(/^https?:\/\/.*\.(jpg|jpeg|png)$/i)) {
        img.src = url;
      } else {
        img.src = 'assets/img/profil-defaut.jpg';
      }
    });
  </script>
</body>

</html>
